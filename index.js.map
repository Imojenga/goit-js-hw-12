{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const createGalleryCard = imgInfo => {\n  return `<li class=\"gallery-item\">\n    <a class=\"gallery-link\" href=\"${imgInfo.largeImageURL}\">\n      <img\n        class=\"gallery-img\"\n        src=\"${imgInfo.webformatURL}\"\n        alt=\"${imgInfo.tags}\"\n      />\n    </a>\n    <ul class=\"gallery-list\">\n      <li class=\"gallery-list-item\">\n        <p class=\"gallery-list-text-name\">Likes</p>\n        <p class=\"gallery-list-text\">${imgInfo.likes}</p>\n      </li>\n      <li class=\"gallery-list-item\">\n        <p class=\"gallery-list-text-name\">Views</p>\n        <p class=\"gallery-list-text\">${imgInfo.views}</p>\n      </li>\n      <li class=\"gallery-list-item\">\n        <p class=\"gallery-list-text-name\">Comments</p>\n        <p class=\"gallery-list-text\">${imgInfo.comments}</p>\n      </li>\n      <li class=\"gallery-list-item\">\n        <p class=\"gallery-list-text-name\">Downloads</p>\n        <p class=\"gallery-list-text\">${imgInfo.downloads}</p>\n      </li>\n    </ul>\n  </li>`;\n};\n","import axios from 'axios';\n\nexport const fetchByQuery = (userQuery, currentPage) => {\n  const axiosOptions = {\n    params: {\n      key: '48469093-05e82502d9118a70767c30ea2',\n      q: userQuery,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: currentPage,\n      per_page: 15,\n    },\n  };\n\n  return axios.get('https://pixabay.com/api/', axiosOptions);\n};\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\n\nimport { createGalleryCard } from './js/render-functions';\nimport { fetchByQuery } from './js/pixabay-api';\n\nconst formEl = document.querySelector('.search-form');\nconst galleryEl = document.querySelector('.gallery');\nconst loadMoreBtnEl = document.querySelector('.load-more-btn');\nconst loaderEl = document.querySelector('.loader');\n\nloaderEl.style.display = 'none';\nlet page = 1;\nlet userQuery = '';\nlet modalWindow;\nlet galleryCardEl;\nlet rect;\nlet downScroll;\n\nconst scrollGallery = downScroll => {\n  window.scrollBy({ top: downScroll, behavior: 'smooth' });\n};\n\nconst onSearchFormSubmit = async event => {\n  try {\n    event.preventDefault();\n    galleryEl.innerHTML = '';\n    loaderEl.style.display = 'block';\n\n    userQuery = event.currentTarget.elements.user_query.value.trim();\n\n    if (!userQuery) {\n      event.currentTarget.elements.user_query.value = '';\n      loaderEl.style.display = 'none';\n      return;\n    }\n\n    page = 1;\n    loadMoreBtnEl.classList.add('is-hidden');\n\n    const { data } = await fetchByQuery(userQuery, page);\n\n    loaderEl.style.display = 'none';\n\n    if (data.total === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching</br> your search query. Please try again!',\n        position: 'topRight',\n      });\n\n      formEl.reset();\n      return;\n    }\n\n    if (data.totalHits / data.hits.length > 1) {\n      loadMoreBtnEl.classList.remove('is-hidden');\n      loadMoreBtnEl.addEventListener('click', onLoadMoreBtnClick);\n    }\n\n    if (data.totalHits === data.hits.length) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n\n    const createGallery = data.hits\n      .map(image => createGalleryCard(image))\n      .join('');\n\n    galleryEl.innerHTML = createGallery;\n\n    modalWindow = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n    });\n\n    modalWindow.refresh();\n\n    galleryCardEl = document.querySelector('.gallery-item');\n    rect = galleryCardEl.getBoundingClientRect();\n\n    downScroll = (rect.bottom - rect.top) * 2 + 48;\n  } catch (error) {\n    loaderEl.style.display = 'none';\n    console.log(error);\n  }\n};\n\nformEl.addEventListener('submit', onSearchFormSubmit);\n\nconst onLoadMoreBtnClick = async event => {\n  try {\n    page++;\n    loaderEl.style.display = 'block';\n\n    const { data } = await fetchByQuery(userQuery, page);\n\n    loaderEl.style.display = 'none';\n\n    const createGallery = data.hits\n      .map(image => createGalleryCard(image))\n      .join('');\n\n    galleryEl.insertAdjacentHTML('beforeend', createGallery);\n\n    modalWindow.refresh();\n\n    scrollGallery(downScroll);\n\n    if (page === Math.ceil(data.totalHits / data.hits.length)) {\n      loadMoreBtnEl.classList.add('is-hidden');\n\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n  } catch (err) {\n    loaderEl.style.display = 'none';\n    console.log(err);\n  }\n};\n"],"names":["createGalleryCard","imgInfo","fetchByQuery","userQuery","currentPage","axiosOptions","axios","formEl","galleryEl","loadMoreBtnEl","loaderEl","page","modalWindow","galleryCardEl","rect","downScroll","scrollGallery","onSearchFormSubmit","event","data","iziToast","onLoadMoreBtnClick","createGallery","image","SimpleLightbox","error","err"],"mappings":"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"}