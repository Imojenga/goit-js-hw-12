{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const createGalleryCard = imgInfo => {\n  return `<li class=\"gallery-item\">\n    <a class=\"gallery-link\" href=\"${imgInfo.largeImageURL}\">\n      <img\n        class=\"gallery-img\"\n        src=\"${imgInfo.webformatURL}\"\n        alt=\"${imgInfo.tags}\"\n      />\n    </a>\n    <ul class=\"gallery-list\">\n      <li class=\"gallery-list-item\">\n        <p class=\"gallery-list-text-name\">Likes</p>\n        <p class=\"gallery-list-text\">${imgInfo.likes}</p>\n      </li>\n      <li class=\"gallery-list-item\">\n        <p class=\"gallery-list-text-name\">Views</p>\n        <p class=\"gallery-list-text\">${imgInfo.views}</p>\n      </li>\n      <li class=\"gallery-list-item\">\n        <p class=\"gallery-list-text-name\">Comments</p>\n        <p class=\"gallery-list-text\">${imgInfo.comments}</p>\n      </li>\n      <li class=\"gallery-list-item\">\n        <p class=\"gallery-list-text-name\">Downloads</p>\n        <p class=\"gallery-list-text\">${imgInfo.downloads}</p>\n      </li>\n    </ul>\n  </li>`;\n};\n","import axios from 'axios';\n\nexport const fetchByQuery = (userQuery, currentPage) => {\n  const axiosOptions = {\n    params: {\n      key: '48469093-05e82502d9118a70767c30ea2',\n      q: userQuery,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: currentPage,\n      per_page: 15,\n    },\n  };\n\n  return axios.get('https://pixabay.com/api/', axiosOptions);\n};\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\n\nimport { createGalleryCard } from './js/render-functions';\nimport { fetchByQuery } from './js/pixabay-api';\n\nconst formEl = document.querySelector('.search-form');\nconst galleryEl = document.querySelector('.gallery');\nconst loadMoreBtnEl = document.querySelector('.load-more-btn');\nconst loaderEl = document.querySelector('.loader');\n\nloaderEl.style.display = 'none';\nlet page = 1;\nlet userQuery = '';\nlet modalWindow;\nlet galleryCardEl;\nlet rect;\nlet downScroll;\nconst perPage = 15;\n\nconst scrollGallery = downScroll => {\n  window.scrollBy({ top: downScroll, behavior: 'smooth' });\n};\n\nconst onSearchFormSubmit = async event => {\n  try {\n    event.preventDefault();\n    loadMoreBtnEl.classList.add('is-hidden');\n    galleryEl.innerHTML = '';\n    page = 1;\n    loaderEl.style.display = 'block';\n\n    userQuery = event.currentTarget.elements.user_query.value.trim();\n\n    if (!userQuery) {\n      event.currentTarget.elements.user_query.value = '';\n      loaderEl.style.display = 'none';\n      iziToast.warning({\n        message: 'Please fill in the field!',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    const { data } = await fetchByQuery(userQuery, page);\n\n    loaderEl.style.display = 'none';\n\n    if (data.total === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching</br> your search query. Please try again!',\n        position: 'topRight',\n      });\n\n      formEl.reset();\n      return;\n    }\n\n    if (data.totalHits / data.hits.length > 1) {\n      loadMoreBtnEl.classList.remove('is-hidden');\n      loadMoreBtnEl.addEventListener('click', onLoadMoreBtnClick);\n    }\n\n    if (data.totalHits === data.hits.length) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n\n    const createGallery = data.hits\n      .map(image => createGalleryCard(image))\n      .join('');\n\n    galleryEl.innerHTML = createGallery;\n\n    modalWindow = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n    });\n\n    modalWindow.refresh();\n\n    galleryCardEl = document.querySelector('.gallery-item');\n    rect = galleryCardEl.getBoundingClientRect();\n\n    downScroll = (rect.bottom - rect.top) * 2 + 48;\n  } catch (error) {\n    loaderEl.style.display = 'none';\n    iziToast.error({\n      message: `${error}`,\n      position: 'topRight',\n    });\n  }\n};\n\nformEl.addEventListener('submit', onSearchFormSubmit);\n\nconst onLoadMoreBtnClick = async event => {\n  try {\n    page++;\n    loaderEl.style.display = 'block';\n\n    const { data } = await fetchByQuery(userQuery, page);\n\n    loaderEl.style.display = 'none';\n\n    const createGallery = data.hits\n      .map(image => createGalleryCard(image))\n      .join('');\n\n    galleryEl.insertAdjacentHTML('beforeend', createGallery);\n\n    modalWindow.refresh();\n\n    scrollGallery(downScroll);\n\n    if (page === Math.ceil(data.totalHits / perPage)) {\n      loadMoreBtnEl.classList.add('is-hidden');\n      loadMoreBtnEl.removeEventListener('click', onLoadMoreBtnClick);\n\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n  } catch (err) {\n    loaderEl.style.display = 'none';\n    iziToast.error({\n      message: `${err}`,\n      position: 'topRight',\n    });\n  }\n};\n"],"names":["createGalleryCard","imgInfo","fetchByQuery","userQuery","currentPage","axiosOptions","axios","formEl","galleryEl","loadMoreBtnEl","loaderEl","page","modalWindow","galleryCardEl","rect","downScroll","perPage","scrollGallery","onSearchFormSubmit","event","iziToast","data","onLoadMoreBtnClick","createGallery","image","SimpleLightbox","error","err"],"mappings":"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"}